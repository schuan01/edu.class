@{ Layout = null; }
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">
    <!--<link rel="shortcut icon" href="../images/favicon.png" type="image/png">-->

    <title>Edu.Class</title>
    @Styles.Render("~/Content/template")
    @Scripts.Render("~/bundles/modernizr")
    <style>
        .cc-selector input{
            margin:0;padding:0;
            -webkit-appearance:none;
            -moz-appearance:none;
            appearance:none;
        }

        .input_hidden {
            position: absolute;
            left: -9999px;
        }

        .cc-selector input:active +.drinkcard-cc{opacity: .9;}
        .cc-selector input:checked +.drinkcard-cc{
                -webkit-filter: none;
                -moz-filter: none;
                filter: none;
        }
        .drinkcard-cc{
            cursor:pointer;
            background-size:contain;
            background-repeat:no-repeat;
            display:inline-block;
            width:322px;height:110px;
            -webkit-transition: all 100ms ease-in;
            -moz-transition: all 100ms ease-in;
            transition: all 100ms ease-in;
            -webkit-filter: brightness(1.8) grayscale(1) opacity(.7);
            -moz-filter: brightness(1.8) grayscale(1) opacity(.7);
            filter: brightness(1.8) grayscale(1) opacity(.7);
        }
        .drinkcard-cc:hover{
                -webkit-filter: brightness(1.2) grayscale(.5) opacity(.9);
                -moz-filter: brightness(1.2) grayscale(.5) opacity(.9);
                filter: brightness(1.2) grayscale(.5) opacity(.9);
        }

        /* Extras */
        a:visited{color:#888}
        a{color:#444;text-decoration:none;}
        p{margin-bottom:.3em;}
    </style>
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
    <script src="js/lib_html5shiv_html5shiv.js"></script>
    <script src="js/lib_respond_respond.src.js"></script>
    <![endif]-->
</head>

<body class="signwrapper">

    <div class="sign-overlay"></div>
    <div class="signpanel"></div>

    <div class="signup">
        <div class="row">
        <div class="col-md-6">
            <div class="panel">
                <div class="panel-heading">
                    <h1>Edu.Class</h1>
                    <h4 class="panel-title">Crear una cuenta</h4>
                </div>
                <div class="panel-body">
                    @using (Html.BeginForm("Register", "Users", FormMethod.Post, htmlAttributes: new { @Id = "registerForm" }))
                    {
                        @Html.AntiForgeryToken()

                        @Html.ValidationSummary(true, "", new { @class = "text-danger" })
                        <h3>Tipo</h3>
                        <section>
                            <h4>Soy* </h4>
                            <div class="cc-selector">
                                <input id="teacher" type="radio" name="PersonType" value="teacher" class="input_hidden required" />
                                <label class="drinkcard-cc btn btn-primary" for="teacher">Profesor</label>
                                <input id="student" type="radio" name="PersonType" value="student" class="input_hidden required"/>
                                <label class="drinkcard-cc btn btn-primary" for="student">Estudiante</label>
                            </div>
                        </section>
                        <h3>Usuario</h3>
                        <section>
                            <label for="userName">Nombre de usuario *</label>
                            <input id="userName" name="userName" type="text" class="form-control required">
                            <label for="email">Correo electrónico *</label>
                            <input id="email" name="email" type="email" class="form-control required">
                            <label for="password">Contraseña *</label>
                            <input id="password" name="password" type="password" class="form-control required">
                            <label for="ConfirmPassword">Confirmación de contraseña *</label>
                            <input id="ConfirmPassword" name="ConfirmPassword" type="password" class="form-control required">
                        </section>
                        <h3>Persona</h3>
                        <section>
                            <label for="firstName">Nombre *</label>
                            <input id="firstName" name="firstName" type="text" class="form-control required">
                            <label for="lastName">Apellido *</label>
                            <input id="lastName" name="lastName" type="text" class="form-control required">
                            <label for="birthday">Fecha de nacimiento *</label>
                            <input id="birthday" name="birthday" type="text" class="form-control hidden" required>
                            <div class="row">
                                <div class="col-md-3">
                                    <select id="selectDay" class="form-control" required>
                                        <option>--</option>
                                    </select>
                                </div>
                                <div class="col-md-5" >
                                    <select id="selectMonth" class="form-control" required>
                                        <option>--</option>
                                    </select>
                                </div>
                                <div class="col-md-4">
                                    <select id="selectYear" class="form-control" required>
                                        <option>----</option>
                                    </select>
                                </div>
                            </div>
                            <label for="identificationCard">Tarjeta de Identificación *</label>
                            <input id="identificationCard" name="identificationCard" type="text" class="form-control required">
                        </section>
                    }
                </div>
            </div>
        </div>
        <div class="col-sm-6">
            <div class="sign-sidebar">
                <h3 class="signtitle mb20">Información</h3>
                <p>Edu.Class es una plataforma sencilla y dinámica  para el manejo de una clase y su profesor.</p>
                <p>Prueba Edu.Class, es gratis!</p>

                <br>

                <h4 class="reason">1. Profesor</h4>
                <p>Podrás crear tus propios grupos y administrarlos. Además de compartir publicaciones con archivos adjuntos entre los alumnos de cualquiera de tus grupos.</p>
                <p>Edu.Class permite manejo de Eventos creados por el profesor, para planificar una fecha de entrega, un Examen o una notificación que le interese a sus alumnos en un día determinado</p>
                <br>

                <h4 class="reason">2. Estudiante</h4>
                <p>Cada Alumno podrá enviar mensajes entre profesores y compañeros de clases. Descargar los archivos del profesor y enterarse de todas sus novedades del grupo</p>

                <hr class="invisible">

                <div class="form-group">
                    <a href="@Url.Action("SignIn", "Users")" class="btn btn-default btn-quirk btn-stroke btn-stroke-thin btn-block btn-sign">¿Ya tienes una cuenta? Inicia sesión!</a>
                </div>
            </div><!-- sign-sidebar -->
        </div>
    </div>
    </div>
    @Scripts.Render("~/bundles/jquery")
    @Scripts.Render("~/bundles/jqueryval")
    @Scripts.Render("~/bundles/template")
    <script src="~/Scripts/app/helpersSite.js"></script>

    @{var sessionMessage = EduClass.Web.Infrastructure.Sessions.MessageSession.GetMessage(); }
    <script>
        var maxYear = 80;
        var currentMonth = new Date().getMonth() + 1;
        var currentYear = new Date().getFullYear();
        var day;
        var month;
        var year;

        $.validator.setDefaults({
            submitHandler: function () {
                alert("submitted!");
            }
        });

        $(document).ready(function () {

            LoadBirthday();

            var form = $("#registerForm");

            form.steps({
                headerTag: "h3",
                bodyTag: "section",
                transitionEffect: "slideLeft",
                labels: {
                    finish: "Finalizar",
                    next: "Siguiente",
                    previous: "Atrás"
                },
                autoFocus: true,
                onStepChanging: function (event, currentIndex, newIndex) {

                    form.validate().settings.ignore = ":disabled,:hidden";
                    return form.valid();
                },
                onFinishing: function (event, currentIndex) {
                    
                    form.validate().settings.ignore = ":disabled";

                    birthday = day + '/' + month + '/' + year;
                    $('#birthday').val(birthday)

                    return form.valid();
                },
                onFinished: function (event, currentIndex) {

                    if (day > daysInMonth(month, year)) {
                        $('#birthday').val('');
                        return form.valid();
                    }

                    this.submit();
                }
            });

            form.validate({
                errorPlacement: function errorPlacement(error, element) { element.before(error); },
                rules: {
               
                    ConfirmPassword: {
                        required: true,
                        minlength: 6,
                        equalTo: "#password"
                    },
                    password: {
                        required: true,
                        minlength: 6
                    },
                    birthday: {
                        required: true
                    }
                }
            });

            $('#selectDay').change(function () {
                if ($(this).val() != null) {
                    day = $(this).val();
                }
            });

            $('#selectMonth').change(function () {
                if ($(this).val() != null) {
                    month = $(this).val();
                }
            });

            $('#selectYear').change(function () {
                if ($(this).val() != null) {
                    year = $(this).val();
                }
            });

            var message = "@Html.Raw(sessionMessage.ToString())";
            if (message != "") {

                showMessageJS(message);
            }
        });

        function LoadBirthday() {
            var months = [{ id: "01", name: "Enero" }, { id: "02", name: "Febrero" }, { id: "03", name: "Marzo" }, { id: "04", name: "Abril" }, { id: "05", name: "Mayo" }, { id: "06", name: "Junio" }, { id: "07", name: "Julio" }, { id: "08", name: "Agosto" }, { id: "09", name: "Septiembre" }, { id: "10", name: "Octubre" }, { id: "11", name: "Noviembre" }, { id: "12", name: "Diciembre" }];

            calculateDays();

            for (var i = 0; i < months.length; i++) {
                $("#selectMonth").append($("<option></option>").val(months[i].id).html(months[i].name));
            }

            for (var i = (currentYear - 10); i > currentYear - maxYear; i--) {
                $("#selectYear").append($("<option></option>").val(i).html(i));
            }
        }

        function calculateDays() {

            for (var i = 1; i < daysInMonth(currentMonth, currentYear) + 1; i++) {

                var number = i;
                if (i < 10) { number = "0" + i; }

                $("#selectDay").append($("<option></option>").val(number).html(number));
            }
        }

        function daysInMonth(month, year) {
            return new Date(year, month, 0).getDate();
        }
    </script>
</body>
</html>
